@using CarMarket.Core.Car.Domain
@if (ShowPopup)
{
    <!-- This is the popup to create or edit a car -->
    <div class="modal" tabindex="-1" style="display:block" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">@TitleContext</h3>
                    <!-- Button to close the popup -->
                    <button type="button" class="close"
                            @onclick="ClosePopup">
                        <span aria-hidden="true">X</span>
                    </button>
                </div>
                <!-- Edit form for the current car -->
                <div class="modal-body">
                    <!-- Only show Id if not a new car -->
                    @if (objCar.Id != 0)
                    {
                        <p>@objCar.Id</p>
                    }
                    
                    <input class="form-control" type="text"
                                placeholder="Name"
                                @bind="objCar.Name" />
                    <input class="form-control" type="text"
                            placeholder="Description"
                            @bind="objCar.Description" />
                    <input class="form-control" type="number"
                            placeholder="Price"
                            @bind="objCar.Price" />
                    <input class="form-control" type="email"
                            placeholder="Owner Email"
                            @bind="objCar.Owner.Email" />
                    <select class="form-control"
                            @bind="@CurrentCarType">
                        @foreach (var option in Options)
                        {
                            <option value="@option">
                                @option
                            </option>
                        }
                    </select>
                    <br /><br />
                    <!-- Button to save the user -->
                    <button class="btn btn-primary"
                            @onclick="SaveCar">
                        Save
                    </button>
                    <!-- Only show delete button if not a new record -->
                    @if (objCar.Id != default)
                    {
                        <!-- Button to delete the forecast -->
                        <button class="btn btn-danger"
                                @onclick="DeleteCar">
                            Delete
                        </button>
                    }
                    <br />
                    <span style="color:red">@strError</span>
                </div>
            </div>
        </div>
    </div>
}
<button class="btn btn-success" @onclick="AddCar">Add Car</button>

@code {
    
    [Parameter]
    public string TitleContext { get; set; }

    CarModel objCar = new();
    // Options to display in the roles dropdown when editing a user
    List<string> Options = new() { "SportCar", "Hatchback" }; // car types
    // To hold any possible errors
    string strError = "";
    // To enable showing the Popup
    bool ShowPopup = false;


    string CurrentCarType { get; set; }

    private async Task AddCar()
    {
    }

    async Task SaveCar()
    {
        ShowPopup = false;
    }
    
    async Task EditCar(CarModel editedCar)
    {
        TitleContext = "Edit car";

        objCar = new CarModel()
        {
            Name = "qq",
            Id = 5,
            Owner = new Core.User.Domain.UserModel() { Id = "qwe" },
            Description = "qwe",
        };

        ShowPopup = true;
    }
    async Task DeleteCar()
    {
        // Close the Popup
        ShowPopup = false;
        // Get the user to delete
    }
    void ClosePopup()
    {
        ShowPopup = false;
    }
}
